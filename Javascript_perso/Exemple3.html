<!DOCTYPE html>
<html>

<head>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }

        #wall {
            border: 2px solid #333;
            padding: 10px;
            margin-top: 10px;
            min-height: 100px;
            background-color: #f9f9f9;
        }

        p {
            border-bottom: 1px solid #ccc;
            padding: 5px;
            background-color: white;
            margin: 5px 0;
            border-radius: 4px;
        }
    </style>
</head>

<body>

    <h1>Le Mur (avec Memoire)</h1>
    <input type="text" id="msgInput" placeholder="Votre message...">
    <button id="pubBtn">Publier</button>
    <button id="clearBtn" style="background:red; color:white;">Tout effacer</button>
    <div id="wall"></div>

    <script>
        const input = document.querySelector("#msgInput");
        const btn = document.querySelector("#pubBtn");
        const wall = document.querySelector("#wall");
        const clearBtn = document.querySelector("#clearBtn");

        // 1. CHARGEMENT : Est-ce qu'il y a déjà des messages en mémoire ?
        // On demande au navigateur : "As-tu quelque chose appelé 'monSuperMur' ?"
        let savedData = localStorage.getItem("monSuperMur");

        // Si savedData existe, on le convertit de TEXTE à TABLEAU. Sinon, on crée un tableau vide [].
        let messages = savedData ? JSON.parse(savedData) : [];

        // 2. FONCTION D'AFFICHAGE (Pour ne pas répéter le code)
        // Cette fonction sert juste à créer le HTML visuel
        function afficherMessage(texte) {
            const newMessage = document.createElement("p");
            newMessage.textContent = texte;
            wall.prepend(newMessage); // On met les nouveaux en haut
        }

        // 3. BOUCLE INITIALE
        // Au démarrage, on affiche tous les messages qu'on a trouvés en mémoire
        messages.forEach(function (msg) {
            afficherMessage(msg);
        });

        // 4. ÉVÉNEMENT : QUAND ON CLIQUE SUR PUBLIER
        btn.addEventListener("click", function () {
            const txt = input.value;
            if (txt === "") return;

            // A. On l'affiche tout de suite à l'écran
            afficherMessage(txt);

            // B. On l'ajoute à notre liste (Tableau) en mémoire JS
            messages.push(txt);

            // C. SAUVEGARDE : On écrase l'ancienne sauvegarde avec la nouvelle liste
            // On transforme le tableau en texte JSON et on l'envoie dans le navigateur
            localStorage.setItem("monSuperMur", JSON.stringify(messages));

            input.value = "";
        });

        // 5. BONUS : BOUTON POUR TOUT EFFACER
        clearBtn.addEventListener("click", function () {
            // On vide la mémoire du navigateur
            localStorage.removeItem("monSuperMur");
            // On vide le tableau JS
            messages = [];
            // On vide l'écran
            wall.innerHTML = "";
        });

    </script>
</body>

</html>